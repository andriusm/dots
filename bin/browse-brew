#!/bin/bash

FORMULA_FILE=$(mktemp)

echo "Fetching brew info..."
ALL_INFO=$(brew info --eval-all --json 2>/dev/null)
echo "Transforming brew info..."
echo "$ALL_INFO" | jq '[.[] | {name, desc, homepage, build_dependencies}]' > "$FORMULA_FILE"

# brew info --eval-all --json | jq '[.[] | {name, desc, homepage, build_dependencies}]' > "$FORMULA_FILE" 2>/dev/null

jq '.[].name' "$FORMULA_FILE" | fzf --preview="jq -r '.[] | select(.name == \"{}\") | \"\(.desc)\n\(.license)\n\(.homepage)\n\(.build_dependencies)\"' $FORMULA_FILE"
